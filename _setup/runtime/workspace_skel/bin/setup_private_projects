#!/usr/bin/env bash
SCRIPT_DIR=$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )
WORKSPACE_DIR=$( cd "$SCRIPT_DIR" && cd .. && pwd )

echo "################################"
echo "Fetching private repos"
echo "################################"

echo "Fetching labs-operations"
echo "------------------------"
git ls-remote "git@github.com:cityindex/labs-operations.git" > /dev/null 2>&1
if [ "$?" -ne 0 ]; then
    echo "WARNING: Unable to read from 'git@github.com:cityindex/labs-operations.git'"
else
   git clone --recursive git@github.com:cityindex/labs-operations.git $WORKSPACE_DIR/environments/labs-operations
   cd $WORKSPACE_DIR/environments/labs-operations
   find . -name .bosh_config.default | sed -e "p;s/.default//" | xargs -n2 cp
fi

echo "Fetching logsearch-filters-internal"
echo "-----------------------------------"
git ls-remote "git@github.com:cityindex/logsearch-filters-internal.git" > /dev/null 2>&1
if [ "$?" -ne 0 ]; then
    echo "WARNING: Unable to read from 'git@github.com:cityindex/logsearch-filters-internal.git'"
else
  git clone --recursive git@github.com:cityindex/logsearch-filters-internal.git $WORKSPACE_DIR/src/logsearch-filters-internal
  (
    cd $WORKSPACE_DIR/src/logsearch-filters-internal
    bin/install_deps.sh 
  )
fi
